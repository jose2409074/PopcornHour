{% extends "base.html" %}
{% block content %}
<section class="flex justify-center items-center py-12">
    <div class="form-container w-full max-w-4xl">
        <h2 class="text-3xl font-bold text-center mb-6">Panel de Administración</h2>
        <a href="{{ url_for('add_movie') }}" class="w-full btn btn-primary mb-6 block text-center"><img src="{{ url_for('static', filename='assets/add_movie.png') }}" class="icon-sm" alt="Agregar Película"> Agregar Nueva Película</a>

        <div class="mt-8">
            <h3 class="text-2xl font-bold mb-4">Gestión de Películas</h3>
            <ul class="space-y-4">
                {% for pelicula in peliculas %}
                <li class="bg-gray-800 p-4 rounded-lg flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <img src="{{ pelicula[2] }}" alt="Portada de {{ pelicula[1] }}" class="admin-movie-img">
                        <span>{{ pelicula[1] }}</span>
                    </div>
                    <div class="flex items-center space-x-2"> <a href="{{ url_for('edit_movie', movie_id=pelicula[0]) }}" class="btn btn-secondary text-xs"><img src="{{ url_for('static', filename='assets/edit.png') }}" class="icon-xs" alt="Editar"> Editar</a>
                        <form action="{{ url_for('delete_movie', movie_id=pelicula[0]) }}" method="post" class="inline">
                            <button type="submit" class="btn btn-primary text-xs"><img src="{{ url_for('static', filename='assets/delete.png') }}" class="icon-xs" alt="Eliminar"> Eliminar</button>
                        </form>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="mt-8">
            <h3 class="text-2xl font-bold mb-4">Gestión de Usuarios</h3>
            <ul class="space-y-4">
                {% for usuario in usuarios %}
                <li class="bg-gray-800 p-4 rounded-lg flex justify-between items-center">
                    <div>
                        <span class="font-semibold">{{ usuario[1] }}</span>
                        <span class="text-gray-400">({{ usuario[3] }})</span>
                    </div>
                    <div class="flex items-center space-x-2"> {% if usuario[3] == 'estandar' %}
                            <form action="{{ url_for('promote_user', user_id=usuario[0]) }}" method="post" class="inline">
                                <button type="submit" class="btn btn-secondary text-xs"><img src="{{ url_for('static', filename='assets/user.png') }}" class="icon-xs" alt="Otorgar Admin"> Otorgar Admin</button>
                            </form>
                        {% elif usuario[0] != session['user_id'] %}
                            <form action="{{ url_for('demote_user', user_id=usuario[0]) }}" method="post" class="inline">
                                <button type="submit" class="btn btn-secondary text-xs"><img src="{{ url_for('static', filename='assets/user.png') }}" class="icon-xs" alt="Revocar Admin"> Revocar Admin</button>
                            </form>
                        {% endif %}
                        {% if usuario[0] != session['user_id'] %}
                            <form action="{{ url_for('delete_user', user_id=usuario[0]) }}" method="post" class="inline">
                                <button type="submit" class="btn btn-primary text-xs"><img src="{{ url_for('static', filename='assets/delete.png') }}" class="icon-xs" alt="Eliminar"> Eliminar</button>
                            </form>
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>

    </div>
</section>
{% endblock %}